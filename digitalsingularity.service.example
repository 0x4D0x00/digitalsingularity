[Unit]
Description=Digital Singularity Backend Service
After=network.target mysql.service redis.service
Wants=mysql.service redis.service

[Service]
Type=simple
User=ubuntu
Group=ubuntu
WorkingDirectory=/program/digitalsingularity
ExecStart=/program/digitalsingularity/digitalsingularity
Restart=always
RestartSec=10
StandardOutput=append:/home/ubuntu/digitalsingularity_logs/service.log
StandardError=append:/home/ubuntu/digitalsingularity_logs/service_error.log

# 环境变量
Environment="PATH=/usr/local/go/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
Environment="GOPROXY=https://goproxy.cn,direct"

# 日志目录（使用用户目录，避免权限问题）
Environment="DIGITALSINGULARITY_LOG_DIR=/home/ubuntu/digitalsingularity_logs"

# 安全设置
LimitNOFILE=65536
LimitNPROC=4096

# 数据库环境变量（根据实际情况调整）
Environment="GIN_MODE=release"
Environment="DB_HOST=localhost"
Environment="DB_PORT=3306"
Environment="DB_USER=root"
Environment="DB_PASSWORD=XXXXXXXXXXXXXXXXXXXXXXXXXXX"
Environment="DB_NAME=XXXXXXXXXXXXXXXXXXXXXXXXXXX"

[Install]
WantedBy=multi-user.target


